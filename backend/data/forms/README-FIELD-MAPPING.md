# PDF Field Position Mapping Guide

This guide explains how to map and adjust field positions for the PLN-FORM.pdf template.

## Overview

The PLN form PDF template is a static PDF without fillable form fields. To fill it with application data, we overlay text at specific coordinates. These coordinates are stored in `field-positions.json` for easy adjustment.

## Files

- **PLN-FORM.pdf** - The original template PDF
- **PLN-FORM-MAPPED.pdf** - Visual reference PDF with marked positions (generated by `map-pdf-fields.js`)
- **field-positions.json** - Configuration file with all field coordinates

## How to Map Field Positions

### Step 1: Generate the Mapped PDF

Run the mapping script to create a visual reference:

```bash
cd backend
node map-pdf-fields.js
```

This creates `data/forms/PLN-FORM-MAPPED.pdf` with:
- A coordinate grid
- Red markers showing estimated field positions
- Field names and coordinates labeled

### Step 2: Review the Mapped PDF

1. Open `PLN-FORM-MAPPED.pdf` in a PDF viewer
2. Compare the red markers with the actual form fields
3. Note any misalignments

### Step 3: Adjust Coordinates

1. Open `field-positions.json`
2. Find the field that needs adjustment
3. Update the `x` and `y` values
4. Save the file

**Note:** PDF coordinates are measured in points (72 points = 1 inch). Y coordinates are from the bottom-left corner (0,0).

### Step 4: Test

1. Submit a test PLN application
2. Download the PDF as an admin
3. Verify the data appears in the correct positions
4. Repeat adjustments as needed

## Coordinate System

- **Origin (0,0)**: Bottom-left corner of the page
- **X-axis**: Increases from left to right
- **Y-axis**: Increases from bottom to top
- **Page size**: A4 = 841.68 x 595.2 points (width x height)

## Field Types

### Checkbox Fields
- Type: `checkbox`
- Draws an "X" mark at the specified position
- Used for: ID types, plate formats, declaration roles, etc.

### Text Fields
- Type: `text`
- Draws text at the specified position
- Has an optional `fontSize` property (default: 9)

## Tips for Finding Exact Coordinates

1. **Use PDF annotation tools**: Open the PDF in Adobe Acrobat or similar software that shows coordinates when you hover over the page

2. **Use the grid**: The mapped PDF includes a 50-point grid to help estimate positions

3. **Test incrementally**: Adjust one field at a time and test to see the change

4. **Account for text alignment**: Text may need slight adjustments to align within boxes or grids

## Field Position Reference

All field positions are defined in `field-positions.json`. Each field has:
- `description`: What the field is for
- `x`: X coordinate in points
- `y`: Y coordinate in points (from bottom of page)
- `type`: Either "checkbox" or "text"
- `fontSize`: Font size for text fields (optional)

## Example Adjustment

If the "Surname" field is appearing 10 points too far to the right:

1. Open `field-positions.json`
2. Find the `surname` field:
```json
"surname": {
  "description": "Surname",
  "x": 80,
  "y": 258,
  "type": "text",
  "fontSize": 9
}
```
3. Change `x` from `80` to `70`
4. Save and test

## Need Help?

If you're having trouble mapping positions:
1. Check the `PLN-FORM-MAPPED.pdf` for visual reference
2. Use a PDF editor with coordinate display
3. Adjust positions incrementally and test frequently


